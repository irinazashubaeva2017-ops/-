<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Finance X</title>

<style>
*{box-sizing:border-box}
html,body{
margin:0;
padding:0;
font-family:-apple-system,BlinkMacSystemFont,sans-serif;
background:#0b1020;
}

.app{
max-width:430px;
margin:auto;
min-height:100vh;
padding:25px 20px;
background:#ffffff;
border-radius:35px;
}

.title{
text-align:center;
font-weight:600;
font-size:20px;
margin-bottom:25px;
letter-spacing:1px;
}

.balance{
text-align:center;
font-size:42px;
font-weight:700;
margin-bottom:25px;
}

.positive{color:#16a34a}
.negative{color:#dc2626}

.summary{
display:flex;
justify-content:space-between;
margin-bottom:25px;
font-weight:600;
}

.summary div{
width:48%;
padding:14px;
border-radius:20px;
text-align:center;
font-size:14px;
}

.incomeBox{
background:#ecfdf5;
color:#16a34a;
}

.expenseBox{
background:#fef2f2;
color:#dc2626;
}

/* переключатель */
.switch{
display:flex;
background:#f1f5f9;
border-radius:20px;
margin-bottom:10px;
overflow:hidden;
}

.switch button{
flex:1;
padding:12px;
border:none;
background:transparent;
font-weight:600;
font-size:14px;
}

.activeIncome{
background:#16a34a;
color:white;
}

.activeExpense{
background:#dc2626;
color:white;
}

input{
width:100%;
padding:14px;
border-radius:20px;
border:none;
background:#f1f5f9;
font-size:15px;
outline:none;
margin-bottom:10px;
}

.mainBtn{
width:100%;
padding:15px;
border-radius:20px;
border:none;
background:#111827;
color:white;
font-size:15px;
font-weight:600;
margin-top:8px;
}

.secondary{
background:#64748b;
}

.history{
margin-top:20px;
}

.item{
display:flex;
justify-content:space-between;
padding:14px 0;
border-bottom:1px solid #e5e7eb;
font-size:15px;
}

.income{color:#16a34a;font-weight:600}
.expense{color:#dc2626;font-weight:600}

.delete{
margin-left:10px;
color:#999;
cursor:pointer;
}
</style>
</head>
<body>

<div class="app" onclick="hideKeyboard(event)">

<div class="title">FINANCE X</div>

<div class="balance" id="balance">0 грн</div>

<div class="summary">
<div class="incomeBox">Доходи<br><span id="incomeTotal">0</span> грн</div>
<div class="expenseBox">Витрати<br><span id="expenseTotal">0</span> грн</div>
</div>

<div class="switch">
<button id="incomeBtn" class="activeIncome" onclick="setType('income')">Дохід</button>
<button id="expenseBtn" onclick="setType('expense')">Витрата</button>
</div>

<input type="number" id="amount" placeholder="Сума">
<input type="text" id="category" placeholder="Категорія">

<button class="mainBtn" onclick="add()">Додати</button>
<button class="mainBtn secondary" onclick="exportData()">Експорт</button>
<button class="mainBtn secondary" onclick="document.getElementById('importFile').click()">Імпорт</button>
<button class="mainBtn secondary" onclick="changePassword()">Змінити пароль</button>

<input type="file" id="importFile" style="display:none" accept=".json" onchange="importData(event)">

<div class="history" id="list"></div>

</div>

<script>

let data=JSON.parse(localStorage.getItem("financeApp"))||[];
let PASSWORD=localStorage.getItem("financePassword")||"1234";
let currentType="income";

function hideKeyboard(e){
if(e.target.tagName!=="INPUT"){
document.activeElement.blur();
}
}

function setType(type){
currentType=type;
document.getElementById("incomeBtn").className="";
document.getElementById("expenseBtn").className="";
if(type==="income"){
document.getElementById("incomeBtn").className="activeIncome";
}else{
document.getElementById("expenseBtn").className="activeExpense";
}
}

function save(){
localStorage.setItem("financeApp",JSON.stringify(data));
}

function render(){
let incomeTotal=0;
let expenseTotal=0;
let list=document.getElementById("list");
list.innerHTML="";

data.forEach((item,index)=>{
if(item.type==="income")incomeTotal+=item.amount;
else expenseTotal+=item.amount;

let div=document.createElement("div");
div.className="item";
div.innerHTML=`
<span>${item.category}</span>
<span class="${item.type}">
${item.type==="income"?"+ ":"- "}${item.amount.toFixed(2)} грн
<span class="delete" onclick="remove(${index})">✕</span>
</span>
`;
list.appendChild(div);
});

let balance=incomeTotal-expenseTotal;
document.getElementById("incomeTotal").innerText=incomeTotal.toFixed(2);
document.getElementById("expenseTotal").innerText=expenseTotal.toFixed(2);

let balanceEl=document.getElementById("balance");
balanceEl.innerText=balance.toFixed(2)+" грн";
balanceEl.className="balance "+(balance>=0?"positive":"negative");
}

function add(){
let amount=parseFloat(document.getElementById("amount").value);
let category=document.getElementById("category").value;
if(!amount||!category)return;

data.unshift({type:currentType,amount,category,date:new Date()});
save();
render();
document.getElementById("amount").value="";
document.getElementById("category").value="";
}

function remove(index){
data.splice(index,1);
save();
render();
}

function exportData(){
if(data.length===0){alert("Немає даних");return;}
let protectedData={password:PASSWORD,payload:data};
const blob=new Blob([JSON.stringify(protectedData,null,2)],{type:"application/json"});
const url=URL.createObjectURL(blob);
const a=document.createElement("a");
a.href=url;
a.download="finance-backup.json";
a.click();
URL.revokeObjectURL(url);
}

function importData(event){
const file=event.target.files[0];
if(!file)return;

const reader=new FileReader();
reader.onload=function(e){
try{
const imported=JSON.parse(e.target.result);
let entered=prompt("Введіть пароль:");
if(entered!==imported.password){alert("Невірний пароль");return;}
data=[...imported.payload,...data];
save();
render();
alert("Імпорт успішний");
}catch{
alert("Помилка імпорту");
}
};
reader.readAsText(file);
}

function changePassword(){
let newPass=prompt("Новий пароль:");
if(newPass){
PASSWORD=newPass;
localStorage.setItem("financePassword",newPass);
alert("Пароль змінено");
}
}

render();

</script>
</body>
</html>
